<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Rust in High Frequency Trading - Sander in 't Veld</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="bt-theme.css">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="bt-highlight.css">
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
<h2 class="r-fit-text">Rust <span class="mark">in High Frequency Trading</span></h2>

<p align="right">30 July 2025</p>
<p align="right">Sander in 't Veld</p>
<p align="right">Rust Meetup <span class="mark">@ BlockTech</span></p>
				</section>


				<section>
<!-- When I joined, I was unsure how much Rust I'd really be writing. -->
<!-- TODO turn into a graph -->
<!-- TODO check these numbers -->
<img src="graph_languages.png"></img>
				</section>


				<section>
<pre><code data-line-numbers class="language-sql">
<script type="text/template">SELECT t.transaction_time,
	t.price,
	t.size,
	o.component_id,
	o.order_id
FROM risk.private_trades t
LEFT JOIN execution.orders o
  ON t.transaction_time = o.transaction_time
</script></code></pre>
<pre><code data-line-numbers class="language-python">
<script type="text/template">class PrivateTrade:
	price: float
	size: float
	transaction_time: datetime
</script></code></pre>
<pre><code data-line-numbers class="language-rust">
<script type="text/template">struct Order {
	component_id: u64,
	order_id: u64,
	transaction_time: SystemTime,
}
</script></code></pre>
				</section>


				<section data-markdown>
					<textarea data-template>
						### Why I enjoy working here</span>
						- Fun
						- Challenging
						- Fast
						- Safe
						- Ambitious
						- Focus on what matters
						- Work with amazing tools
						- Smart people from different fields
					</textarea>
				</section>


				<section data-markdown>
					<textarea data-template>
						### Why Rust is great <span class="mark">in HFT</span>
						- Fun and challenging
						- Fast
						- No segfaults
						- No buffer overflows or uninitialized data
						- No memory leaks
						- Great
					</textarea>
				</section>


				<section>
<pre><code data-line-numbers class="language-rust">
<script type="text/template">#[derive(Clone, Copy)]
pub struct Greeks {
    pub delta: f32,
    pub gamma: f32,
    pub theta: f32,
    pub vega: f32,
}
</script></code></pre>
				</section>


				<section>
<pre><code data-line-numbers class="language-rust">
<script type="text/template">#[derive(Clone, Copy)]
pub struct Delta(pub f32);

#[derive(Clone, Copy)]
pub struct Gamma(pub f32);

#[derive(Clone, Copy)]
pub struct Theta(pub f32);

#[derive(Clone, Copy)]
pub struct Vega(pub f32);
</script></code></pre>
				</section>


				<section>
<pre><code data-line-numbers class="language-rust">
<script type="text/template">#[derive(Clone, Copy)]
pub struct Greeks {
    pub delta: Delta,
    pub gamma: Gamma,
    pub theta: Theta,
    pub vega: Vega,
}
</script></code></pre>
				</section>


				<section>
<pre><code data-line-numbers class="language-rust">
<script type="text/template">pub trait Worker {
    fn update(&mut self, id: Id, greeks: Greeks);

    fn total_delta(&self) -> Delta;
    fn total_gamma(&self) -> Gamma;
    fn total_theta(&self) -> Theta;
    fn total_vega(&self) -> Vega;

    fn total_greeks(&self) -> Greeks;
}
</script></code></pre>
				</section>


				<section>
<pre><code data-line-numbers class="language-rust">
<script type="text/template">#[derive(Clone, Copy, PartialEq, Eq, Hash)]
pub struct Id(pub u32);

#[derive(Clone, Copy, PartialEq, Add, AddAssign, Sum)]
pub struct Delta(pub f32);

#[derive(Clone, Copy, PartialEq, Add, AddAssign, Sum)]
pub struct Gamma(pub f32);

#[derive(Clone, Copy, PartialEq, Add, AddAssign, Sum)]
pub struct Theta(pub f32);

#[derive(Clone, Copy, PartialEq, Add, AddAssign, Sum)]
pub struct Vega(pub f32);
</script></code></pre>
				</section>


				<section>
<pre><code data-line-numbers class="language-rust">
<script type="text/template">pub struct NaiveWorker {
    greeks: Vec<InstrumentData>,
}

impl Worker for NaiveWorker {
    fn update(&mut self, id: Id, greeks: Greeks) {
        if let Some(entry) =
            self.greeks.iter_mut().find(|x| x.id == id)
        {
            entry.greeks = greeks;
        } else {
            self.greeks.push(InstrumentData { id, greeks });
        }
    }
</script></code></pre>
				</section>


				<section>
<pre><code data-line-numbers class="language-rust">
<script type="text/template">impl Worker for NaiveWorker {
    // ...
    fn total_delta(&self) -> Delta {
        self.greeks.iter().map(|x| x.greeks.delta).sum()
    }

    fn total_gamma(&self) -> Gamma {
        self.greeks.iter().map(|x| x.greeks.gamma).sum()
    }
    //...
    fn total_greeks(&self) -> Greeks {
        Greeks {
            delta: self.total_delta(),
            gamma: self.total_gamma(),
            theta: self.total_theta(),
            vega: self.total_vega(),
        }
    }
}
</script></code></pre>
				</section>


				<section>
<pre><code data-line-numbers class="language-x86asm">
<script type="text/template">	.p2align	4
.LBB40_2:
	vaddps ymm15, ymm15, ymmword ptr [rax]
	vaddps ymm14, ymm14, ymmword ptr [rax + 32]
	vaddps ymm13, ymm13, ymmword ptr [rax + 64]
	vaddps ymm12, ymm12, ymmword ptr [rax + 96]
; ...
	vaddps ymm2, ymm2, ymmword ptr [rax + 416]
	vaddps ymm1, ymm1, ymmword ptr [rax + 448]
	vaddps ymm0, ymm0, ymmword ptr [rax + 480]
	add rcx, -128
	add rax, 512
	cmp rcx, 127
	ja .LBB40_2
</script></code></pre>
				</section>


				<section>Slide 2</section>
			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
			});
		</script>
	</body>
</html>
